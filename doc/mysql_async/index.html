<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Tokio based asynchronous MySql client library for The Rust Programming Language."><meta name="keywords" content="rust, rustlang, rust-lang, mysql_async"><title>mysql_async - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-93196c7a1c3542a8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-4743e13df3dfe8c4.css"><link rel="stylesheet" disabled href="../static.files/dark-0e1b889528bd466b.css"><link rel="stylesheet" disabled href="../static.files/ayu-65289d5d067c7c66.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../mysql_async/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../mysql_async/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate mysql_async</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.31.3</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">mysql_async</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/mysql_async/lib.rs.html#9-642">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Tokio based asynchronous MySql client library for The Rust Programming Language.</p>
<h2 id="installation"><a href="#installation">Installation</a></h2>
<p>The library is hosted on <a href="https://crates.io/crates/mysql_async/">crates.io</a>.</p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = &quot;&lt;desired version&gt;&quot;
</code></pre></div><h2 id="crate-features"><a href="#crate-features">Crate Features</a></h2>
<p>Default feature set is wide – it includes all default <a href="https://github.com/blackbeam/rust_mysql_common#crate-features"><code>mysql_common</code> features</a>
as well as <code>native-tls</code>-based TLS support.</p>
<h3 id="list-of-features"><a href="#list-of-features">List Of Features</a></h3>
<ul>
<li>
<p><code>minimal</code> – enables only necessary features (at the moment the only necessary feature
is <code>flate2</code> backend). Enables:</p>
<ul>
<li>`flate2/zlib“</li>
</ul>
<p><strong>Example:</strong></p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, default-features = false, features = [&quot;minimal&quot;]}
</code></pre></div>
<p>*<em>Note:</em> it is possible to use another <code>flate2</code> backend by directly choosing it:</p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, default-features = false }
flate2 = { version = &quot;*&quot;, default-features = false, features = [&quot;rust_backend&quot;] }
</code></pre></div></li>
<li>
<p><code>default</code> – enables the following set of crate’s and dependencies’ features:</p>
<ul>
<li><code>native-tls-tls</code></li>
<li>`flate2/zlib“</li>
<li><code>mysql_common/bigdecimal03</code></li>
<li><code>mysql_common/rust_decimal</code></li>
<li><code>mysql_common/time03</code></li>
<li><code>mysql_common/uuid</code></li>
<li><code>mysql_common/frunk</code></li>
</ul>
</li>
<li>
<p><code>default-rustls</code> – same as default but with <code>rustls-tls</code> instead of <code>native-tls-tls</code>.</p>
<p><strong>Example:</strong></p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, default-features = false, features = [&quot;default-rustls&quot;] }
</code></pre></div></li>
<li>
<p><code>native-tls-tls</code> – enables <code>native-tls</code>-based TLS support <em>(conflicts with <code>rustls-tls</code>)</em></p>
<p><strong>Example:</strong></p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, default-features = false, features = [&quot;native-tls-tls&quot;] }

</code></pre></div></li>
<li>
<p><code>rustls-tls</code> – enables <code>native-tls</code>-based TLS support <em>(conflicts with <code>native-tls-tls</code>)</em></p>
<p><strong>Example:</strong></p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, default-features = false, features = [&quot;rustls-tls&quot;] }

</code></pre></div></li>
<li>
<p><code>tracing</code> – enables instrumentation via <code>tracing</code> package.</p>
<p>Primary operations (<code>query</code>, <code>prepare</code>, <code>exec</code>) are instrumented at <code>INFO</code> level.
Remaining operations, incl. <code>get_conn</code>, are instrumented at <code>DEBUG</code> level.
Also at <code>DEBUG</code>, the SQL queries and parameters are added to the <code>query</code>, <code>prepare</code>
and <code>exec</code> spans. Also some internal queries are instrumented at <code>TRACE</code> level.</p>
<p><strong>Example:</strong></p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
mysql_async = { version = &quot;*&quot;, features = [&quot;tracing&quot;] }
</code></pre></div></li>
</ul>
<h2 id="tlsssl-support"><a href="#tlsssl-support">TLS/SSL Support</a></h2>
<p>SSL support comes in two flavors:</p>
<ol>
<li>
<p>Based on native-tls – this is the default option, that usually works without pitfalls
(see the <code>native-tls-tls</code> crate feature).</p>
</li>
<li>
<p>Based on rustls – TLS backend written in Rust (see the <code>rustls-tls</code> crate feature).</p>
<p>Please also note a few things about rustls:</p>
<ul>
<li>it will fail if you’ll try to connect to the server by its IP address,
hostname is required;</li>
<li>it, most likely, won’t work on windows, at least with default server certs,
generated by the MySql installer.</li>
</ul>
</li>
</ol>
<h2 id="connection-url-parameters"><a href="#connection-url-parameters">Connection URL parameters</a></h2>
<p>There is a set of url-parameters supported by the driver (see documentation on <a href="struct.Opts.html" title="Opts"><code>Opts</code></a>).</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>mysql_async::prelude::<span class="kw-2">*</span>;

<span class="attr">#[derive(Debug, PartialEq, Eq, Clone)]
</span><span class="kw">struct </span>Payment {
    customer_id: i32,
    amount: i32,
    account_name: <span class="prelude-ty">Option</span>&lt;String&gt;,
}

<span class="attr">#[tokio::main]
</span><span class="kw">async fn </span>main() -&gt; <span class="prelude-ty">Result</span>&lt;()&gt; {
    <span class="kw">let </span>payments = <span class="macro">vec!</span>[
        Payment { customer_id: <span class="number">1</span>, amount: <span class="number">2</span>, account_name: <span class="prelude-val">None </span>},
        Payment { customer_id: <span class="number">3</span>, amount: <span class="number">4</span>, account_name: <span class="prelude-val">Some</span>(<span class="string">&quot;foo&quot;</span>.into()) },
        Payment { customer_id: <span class="number">5</span>, amount: <span class="number">6</span>, account_name: <span class="prelude-val">None </span>},
        Payment { customer_id: <span class="number">7</span>, amount: <span class="number">8</span>, account_name: <span class="prelude-val">None </span>},
        Payment { customer_id: <span class="number">9</span>, amount: <span class="number">10</span>, account_name: <span class="prelude-val">Some</span>(<span class="string">&quot;bar&quot;</span>.into()) },
    ];

    <span class="kw">let </span>database_url = <span class="comment">/* ... */

    </span><span class="kw">let </span>pool = mysql_async::Pool::new(database_url);
    <span class="kw">let </span><span class="kw-2">mut </span>conn = pool.get_conn().<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="comment">// Create a temporary table
    </span><span class="string">r&quot;CREATE TEMPORARY TABLE payment (
        customer_id int not null,
        amount int not null,
        account_name text
    )&quot;</span>.ignore(<span class="kw-2">&amp;mut </span>conn).<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="comment">// Save payments
    </span><span class="string">r&quot;INSERT INTO payment (customer_id, amount, account_name)
      VALUES (:customer_id, :amount, :account_name)&quot;
        </span>.with(payments.iter().map(|payment| <span class="macro">params! </span>{
            <span class="string">&quot;customer_id&quot; </span>=&gt; payment.customer_id,
            <span class="string">&quot;amount&quot; </span>=&gt; payment.amount,
            <span class="string">&quot;account_name&quot; </span>=&gt; payment.account_name.as_ref(),
        }))
        .batch(<span class="kw-2">&amp;mut </span>conn)
        .<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="comment">// Load payments from the database. Type inference will work here.
    </span><span class="kw">let </span>loaded_payments = <span class="string">&quot;SELECT customer_id, amount, account_name FROM payment&quot;
        </span>.with(())
        .map(<span class="kw-2">&amp;mut </span>conn, |(customer_id, amount, account_name)| Payment { customer_id, amount, account_name })
        .<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="comment">// Dropped connection will go to the pool
    </span>drop(conn);

    <span class="comment">// The Pool must be disconnected explicitly because
    // it&#39;s an asynchronous operation.
    </span>pool.disconnect().<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="macro">assert_eq!</span>(loaded_payments, payments);

    <span class="comment">// the async fn returns Result, so
    </span><span class="prelude-val">Ok</span>(())
}</code></pre></div>
<h2 id="pool"><a href="#pool">Pool</a></h2>
<p>The <a href="struct.Pool.html" title="Pool"><code>Pool</code></a> structure is an asynchronous connection pool.</p>
<p>Please note:</p>
<ul>
<li><a href="struct.Pool.html" title="Pool"><code>Pool</code></a> is a smart pointer – each clone will point to the same pool instance.</li>
<li><a href="struct.Pool.html" title="Pool"><code>Pool</code></a> is <code>Send + Sync + 'static</code> – feel free to pass it around.</li>
<li>use <a href="struct.Pool.html#method.disconnect" title="Pool::disconnect"><code>Pool::disconnect</code></a> to gracefuly close the pool.</li>
<li><a href="struct.Pool.html#method.new" title="Pool::new"><code>Pool::new</code></a> is lazy and won’t assert server availability.</li>
</ul>
<h2 id="transaction"><a href="#transaction">Transaction</a></h2>
<p><a href="struct.Conn.html#method.start_transaction" title="Conn::start_transaction"><code>Conn::start_transaction</code></a> is a wrapper, that starts with <code>START TRANSACTION</code>
and ends with <code>COMMIT</code> or <code>ROLLBACK</code>.</p>
<p>Dropped transaction will be implicitly rolled back if it wasn’t explicitly
committed or rolled back. Note that this behaviour will be triggered by a pool
(on conn drop) or by the next query, i.e. may be delayed.</p>
<p>API won’t allow you to run nested transactions because some statements causes
an implicit commit (<code>START TRANSACTION</code> is one of them), so this behavior
is chosen as less error prone.</p>
<h2 id="value"><a href="#value"><code>Value</code></a></h2>
<p>This enumeration represents the raw value of a MySql cell. Library offers conversion between
<code>Value</code> and different rust types via <code>FromValue</code> trait described below.</p>
<h3 id="fromvalue-trait"><a href="#fromvalue-trait"><code>FromValue</code> trait</a></h3>
<p>This trait is reexported from <strong>mysql_common</strong> create. Please refer to its
<a href="https://docs.rs/mysql_common">crate docs</a> for the list of supported conversions.</p>
<p>Trait offers conversion in two flavours:</p>
<ul>
<li>
<p><code>from_value(Value) -&gt; T</code> - convenient, but panicking conversion.</p>
<p>Note, that for any variant of <code>Value</code> there exist a type, that fully covers its domain,
i.e. for any variant of <code>Value</code> there exist <code>T: FromValue</code> such that <code>from_value</code> will never
panic. This means, that if your database schema is known, than it’s possible to write your
application using only <code>from_value</code> with no fear of runtime panic.</p>
<p>Also note, that some convertions may fail even though the type seem sufficient,
e.g. in case of invalid dates (see <a href="https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html">sql mode</a>).</p>
</li>
<li>
<p><code>from_value_opt(Value) -&gt; Option&lt;T&gt;</code> - non-panicking, but less convenient conversion.</p>
<p>This function is useful to probe conversion in cases, where source database schema
is unknown.</p>
</li>
</ul>
<h2 id="mysql-query-protocols"><a href="#mysql-query-protocols">MySql query protocols</a></h2><h3 id="text-protocol"><a href="#text-protocol">Text protocol</a></h3>
<p>MySql text protocol is implemented in the set of <code>Queryable::query*</code> methods
and in the <a href="prelude/trait.Query.html" title="prelude::Query"><code>prelude::Query</code></a> trait if query is <a href="prelude/trait.AsQuery.html" title="prelude::AsQuery"><code>prelude::AsQuery</code></a>.
It’s useful when your query doesn’t have parameters.</p>
<p><strong>Note:</strong> All values of a text protocol result set will be encoded as strings by the server,
so <code>from_value</code> conversion may lead to additional parsing costs.</p>
<h3 id="binary-protocol-and-prepared-statements"><a href="#binary-protocol-and-prepared-statements">Binary protocol and prepared statements.</a></h3>
<p>MySql binary protocol is implemented in the set of <code>exec*</code> methods,
defined on the <a href="prelude/trait.Queryable.html" title="prelude::Queryable"><code>prelude::Queryable</code></a> trait and in the <a href="prelude/trait.Query.html" title="prelude::Query"><code>prelude::Query</code></a>
trait if query is <a href="struct.QueryWithParams.html" title="QueryWithParams"><code>QueryWithParams</code></a>. Prepared statements is the only way to
pass rust value to the MySql server. MySql uses <code>?</code> symbol as a parameter placeholder.</p>
<p><strong>Note:</strong> it’s only possible to use parameters where a single MySql value
is expected, i.e. you can’t execute something like <code>SELECT ... WHERE id IN ?</code>
with a vector as a parameter. You’ll need to build a query that looks like
<code>SELECT ... WHERE id IN (?, ?, ...)</code> and to pass each vector element as
a parameter.</p>
<h2 id="named-parameters"><a href="#named-parameters">Named parameters</a></h2>
<p>MySql itself doesn’t have named parameters support, so it’s implemented on the client side.
One should use <code>:name</code> as a placeholder syntax for a named parameter. Named parameters uses
the following naming convention:</p>
<ul>
<li>parameter name must start with either <code>_</code> or <code>a..z</code></li>
<li>parameter name may continue with <code>_</code>, <code>a..z</code> and <code>0..9</code></li>
</ul>
<p><strong>Note:</strong> this rules mean that, say, the statment <code>SELECT :fooBar</code> will be translated
to <code>SELECT ?Bar</code> so please be careful.</p>
<p>Named parameters may be repeated within the statement, e.g <code>SELECT :foo, :foo</code> will require
a single named parameter <code>foo</code> that will be repeated on the corresponding positions during
statement execution.</p>
<p>One should use the <code>params!</code> macro to build parameters for execution.</p>
<p><strong>Note:</strong> Positional and named parameters can’t be mixed within the single statement.</p>
<h2 id="statements"><a href="#statements">Statements</a></h2>
<p>In MySql each prepared statement belongs to a particular connection and can’t be executed
on another connection. Trying to do so will lead to an error. The driver won’t tie statement
to its connection in any way, but one can look on to the connection id, contained
in the <a href="struct.Statement.html" title="Statement"><code>Statement</code></a> structure.</p>
<h2 id="local-infile-handlers"><a href="#local-infile-handlers">LOCAL INFILE Handlers</a></h2>
<p><strong>Warning:</strong> You should be aware of <a href="https://dev.mysql.com/doc/refman/8.0/en/load-data-local-security.html">Security Considerations for LOAD DATA LOCAL</a>.</p>
<p>There are two flavors of LOCAL INFILE handlers – <em>global</em> and <em>local</em>.</p>
<p>I case of a LOCAL INFILE request from the server the driver will try to find a handler for it:</p>
<ol>
<li>It’ll try to use <em>local</em> handler installed on the connection, if any;</li>
<li>It’ll try to use <em>global</em> handler, specified via <a href="struct.OptsBuilder.html#method.local_infile_handler" title="OptsBuilder::local_infile_handler"><code>OptsBuilder::local_infile_handler</code></a>,
if any;</li>
<li>It will emit <a href="enum.LocalInfileError.html#variant.NoHandler" title="LocalInfileError::NoHandler"><code>LocalInfileError::NoHandler</code></a> if no handlers found.</li>
</ol>
<p>The purpose of a handler (<em>local</em> or <em>global</em>) is to return <a href="type.InfileData.html" title="InfileData"><code>InfileData</code></a>.</p>
<h3 id="global-local-infile-handler"><a href="#global-local-infile-handler"><em>Global</em> LOCAL INFILE handler</a></h3>
<p>See <a href="prelude/trait.GlobalHandler.html" title="prelude::GlobalHandler"><code>prelude::GlobalHandler</code></a>.</p>
<p>Simply speaking the <em>global</em> handler is an async function that takes a file name (as <code>&amp;[u8]</code>)
and returns <code>Result&lt;InfileData&gt;</code>.</p>
<p>You can set it up using <a href="struct.OptsBuilder.html#method.local_infile_handler" title="OptsBuilder::local_infile_handler"><code>OptsBuilder::local_infile_handler</code></a>. Server will use it if there is no
<em>local</em> handler installed for the connection. This handler might be called multiple times.</p>
<p>Examles:</p>
<ol>
<li><a href="struct.WhiteListFsHandler.html" title="WhiteListFsHandler"><code>WhiteListFsHandler</code></a> is a <em>global</em> handler.</li>
<li>Every <code>T: Fn(&amp;[u8]) -&gt; BoxFuture&lt;'static, Result&lt;InfileData, LocalInfileError&gt;&gt;</code>
is a <em>global</em> handler.</li>
</ol>
<h3 id="local-local-infile-handler"><a href="#local-local-infile-handler"><em>Local</em> LOCAL INFILE handler.</a></h3>
<p>Simply speaking the <em>local</em> handler is a future, that returns <code>Result&lt;InfileData&gt;</code>.</p>
<p>This is a one-time handler – it’s consumed after use. You can set it up using
<a href="struct.Conn.html#method.set_infile_handler" title="Conn::set_infile_handler"><code>Conn::set_infile_handler</code></a>. This handler have priority over <em>global</em> handler.</p>
<p>Worth noting:</p>
<ol>
<li><code>impl Drop for Conn</code> will clear <em>local</em> handler, i.e. handler will be removed when
connection is returned to a <code>Pool</code>.</li>
<li><a href="struct.Conn.html#method.reset" title="Conn::reset"><code>Conn::reset</code></a> will clear <em>local</em> handler.</li>
</ol>
<p>Example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>pool = mysql_async::Pool::new(database_url);

<span class="kw">let </span><span class="kw-2">mut </span>conn = pool.get_conn().<span class="kw">await</span><span class="question-mark">?</span>;
<span class="string">&quot;CREATE TEMPORARY TABLE tmp (id INT, val TEXT)&quot;</span>.ignore(<span class="kw-2">&amp;mut </span>conn).<span class="kw">await</span><span class="question-mark">?</span>;

<span class="comment">// We are going to call `LOAD DATA LOCAL` so let&#39;s setup a one-time handler.
</span>conn.set_infile_handler(<span class="kw">async move </span>{
    <span class="comment">// We need to return a stream of `io::Result&lt;Bytes&gt;`
    </span><span class="prelude-val">Ok</span>(stream::iter([Bytes::from(<span class="string">&quot;1,a\r\n&quot;</span>), Bytes::from(<span class="string">&quot;2,b\r\n3,c&quot;</span>)]).map(<span class="prelude-val">Ok</span>).boxed())
});

<span class="kw">let </span>result = <span class="string">r#&quot;LOAD DATA LOCAL INFILE &#39;whatever&#39;
    INTO TABLE `tmp`
    FIELDS TERMINATED BY &#39;,&#39; ENCLOSED BY &#39;\&quot;&#39;
    LINES TERMINATED BY &#39;\r\n&#39;&quot;#</span>.ignore(<span class="kw-2">&amp;mut </span>conn).<span class="kw">await</span>;

<span class="kw">match </span>result {
    <span class="prelude-val">Ok</span>(()) =&gt; (),
    <span class="prelude-val">Err</span>(Error::Server(<span class="kw-2">ref </span>err)) <span class="kw">if </span>err.code == <span class="number">1148 </span>=&gt; {
        <span class="comment">// The used command is not allowed with this MySQL version
        </span><span class="kw">return </span><span class="prelude-val">Ok</span>(());
    },
    <span class="prelude-val">Err</span>(Error::Server(<span class="kw-2">ref </span>err)) <span class="kw">if </span>err.code == <span class="number">3948 </span>=&gt; {
        <span class="comment">// Loading local data is disabled;
        // this must be enabled on both the client and the server
        </span><span class="kw">return </span><span class="prelude-val">Ok</span>(());
    }
    e @ <span class="prelude-val">Err</span>(<span class="kw">_</span>) =&gt; e.unwrap(),
}

<span class="comment">// Now let&#39;s verify the result
</span><span class="kw">let </span>result: Vec&lt;(u32, String)&gt; = conn.query(<span class="string">&quot;SELECT * FROM tmp ORDER BY id ASC&quot;</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="macro">assert_eq!</span>(
    result,
    <span class="macro">vec!</span>[(<span class="number">1</span>, <span class="string">&quot;a&quot;</span>.into()), (<span class="number">2</span>, <span class="string">&quot;b&quot;</span>.into()), (<span class="number">3</span>, <span class="string">&quot;c&quot;</span>.into())]
);

drop(conn);
pool.disconnect().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>Tests uses followin environment variables:</p>
<ul>
<li><code>DATABASE_URL</code> – defaults to <code>mysql://root:password@127.0.0.1:3307/mysql</code></li>
<li><code>COMPRESS</code> – set to <code>1</code> or <code>true</code> to enable compression for tests</li>
<li><code>SSL</code> – set to <code>1</code> or <code>true</code> to enable TLS for tests</li>
</ul>
<p>You can run a test server using doker. Please note that params related
to max allowed packet, local-infile and binary logging are required
to properly run tests (please refer to <code>azure-pipelines.yml</code>):</p>
<div class="example-wrap"><pre class="language-sh"><code>docker run -d --name container \
    -v `pwd`:/root \
    -p 3307:3306 \
    -e MYSQL_ROOT_PASSWORD=password \
    mysql:8.0 \
    --max-allowed-packet=36700160 \
    --local-infile \
    --log-bin=mysql-bin \
    --log-slave-updates \
    --gtid_mode=ON \
    --enforce_gtid_consistency=ON \
    --server-id=1
</code></pre></div></div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="binlog/index.html" title="mysql_async::binlog mod">binlog</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="consts/index.html" title="mysql_async::consts mod">consts</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="futures/index.html" title="mysql_async::futures mod">futures</a></div><div class="item-right docblock-short">Futures used in this crate</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="params/index.html" title="mysql_async::params mod">params</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="prelude/index.html" title="mysql_async::prelude mod">prelude</a></div><div class="item-right docblock-short">Traits used in this crate</div></div></div><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.params.html" title="mysql_async::params macro">params</a></div><div class="item-right docblock-short">This macro is a convenient way to pass named parameters to a statement.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BinaryProtocol.html" title="mysql_async::BinaryProtocol struct">BinaryProtocol</a></div><div class="item-right docblock-short">Phantom struct used to specify MySql binary protocol.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BinlogDumpFlags.html" title="mysql_async::BinlogDumpFlags struct">BinlogDumpFlags</a></div><div class="item-right docblock-short">Empty flags of a <code>LoadEvent</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BinlogRequest.html" title="mysql_async::BinlogRequest struct">BinlogRequest</a></div><div class="item-right docblock-short">Binlog request representation. Please consult MySql documentation.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BinlogStream.html" title="mysql_async::BinlogStream struct">BinlogStream</a></div><div class="item-right docblock-short">Binlog event stream.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ClientIdentity.html" title="mysql_async::ClientIdentity struct">ClientIdentity</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Column.html" title="mysql_async::Column struct">Column</a></div><div class="item-right docblock-short">Represents MySql Column (column packet).</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Compression.html" title="mysql_async::Compression struct">Compression</a></div><div class="item-right docblock-short">When compressing data, the compression level can be specified by a value in
this enum.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Conn.html" title="mysql_async::Conn struct">Conn</a></div><div class="item-right docblock-short">MySql server connection.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Deserialized.html" title="mysql_async::Deserialized struct">Deserialized</a></div><div class="item-right docblock-short">Use it to parse <code>T: Deserialize</code> from <code>Value</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FromRowError.html" title="mysql_async::FromRowError struct">FromRowError</a></div><div class="item-right docblock-short"><code>FromRow</code> conversion error.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FromValueError.html" title="mysql_async::FromValueError struct">FromValueError</a></div><div class="item-right docblock-short"><code>FromValue</code> conversion error.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Gtids.html" title="mysql_async::Gtids struct">Gtids</a></div><div class="item-right docblock-short">This tracker type indicates that GTIDs are available and contains the GTID string.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Interval.html" title="mysql_async::Interval struct">Interval</a></div><div class="item-right docblock-short">Interval. Stored within <a href="struct.Sid.html" title="Sid"><code>Sid</code></a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.OkPacket.html" title="mysql_async::OkPacket struct">OkPacket</a></div><div class="item-right docblock-short">Represents MySql’s Ok packet.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Opts.html" title="mysql_async::Opts struct">Opts</a></div><div class="item-right docblock-short">Mysql connection options.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.OptsBuilder.html" title="mysql_async::OptsBuilder struct">OptsBuilder</a></div><div class="item-right docblock-short">Provides a way to build <a href="struct.Opts.html" title="Opts"><code>Opts</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Pool.html" title="mysql_async::Pool struct">Pool</a></div><div class="item-right docblock-short">Asynchronous pool of MySql connections.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PoolConstraints.html" title="mysql_async::PoolConstraints struct">PoolConstraints</a></div><div class="item-right docblock-short">Connection pool constraints.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PoolOpts.html" title="mysql_async::PoolOpts struct">PoolOpts</a></div><div class="item-right docblock-short">Connection pool options.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.QueryResult.html" title="mysql_async::QueryResult struct">QueryResult</a></div><div class="item-right docblock-short">Result of a query or statement execution.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.QueryWithParams.html" title="mysql_async::QueryWithParams struct">QueryWithParams</a></div><div class="item-right docblock-short">Representation of a prepared statement query.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ResultSetStream.html" title="mysql_async::ResultSetStream struct">ResultSetStream</a></div><div class="item-right docblock-short">Rows stream for a single result set.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Row.html" title="mysql_async::Row struct">Row</a></div><div class="item-right docblock-short">Client side representation of a MySql row.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Schema.html" title="mysql_async::Schema struct">Schema</a></div><div class="item-right docblock-short">This tracker type indicates that the default schema has been set.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Serialized.html" title="mysql_async::Serialized struct">Serialized</a></div><div class="item-right docblock-short">Use it to pass <code>T: Serialize</code> as JSON to a prepared statement.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ServerError.html" title="mysql_async::ServerError struct">ServerError</a></div><div class="item-right docblock-short">This type represents MySql server error.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SessionStateInfo.html" title="mysql_async::SessionStateInfo struct">SessionStateInfo</a></div><div class="item-right docblock-short">Represents change in session state (part of MySql’s Ok packet).</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Sid.html" title="mysql_async::Sid struct">Sid</a></div><div class="item-right docblock-short">SID is a part of the <code>COM_BINLOG_DUMP_GTID</code> command.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SslOpts.html" title="mysql_async::SslOpts struct">SslOpts</a></div><div class="item-right docblock-short">Ssl Options.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Statement.html" title="mysql_async::Statement struct">Statement</a></div><div class="item-right docblock-short">Prepared statement.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SystemVariable.html" title="mysql_async::SystemVariable struct">SystemVariable</a></div><div class="item-right docblock-short">This tracker type indicates that one or more tracked session
system variables have been assigned a value.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TextProtocol.html" title="mysql_async::TextProtocol struct">TextProtocol</a></div><div class="item-right docblock-short">Phantom struct used to specify MySql text protocol.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Transaction.html" title="mysql_async::Transaction struct">Transaction</a></div><div class="item-right docblock-short">This struct represents MySql transaction.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TransactionCharacteristics.html" title="mysql_async::TransactionCharacteristics struct">TransactionCharacteristics</a></div><div class="item-right docblock-short">This tracker type indicates that transaction characteristics are available.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TransactionState.html" title="mysql_async::TransactionState struct">TransactionState</a></div><div class="item-right docblock-short">This tracker type indicates that transaction state information is available.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TxOpts.html" title="mysql_async::TxOpts struct">TxOpts</a></div><div class="item-right docblock-short">Transaction options.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Unsupported.html" title="mysql_async::Unsupported struct">Unsupported</a></div><div class="item-right docblock-short">This tracker type is unknown/unsupported.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.WhiteListFsHandler.html" title="mysql_async::WhiteListFsHandler struct">WhiteListFsHandler</a></div><div class="item-right docblock-short">Handles <code>LOCAL INFILE</code> requests from filesystem using an explicit whitelist of paths.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.DriverError.html" title="mysql_async::DriverError enum">DriverError</a></div><div class="item-right docblock-short">This type enumerates driver errors.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="mysql_async::Error enum">Error</a></div><div class="item-right docblock-short">This type enumerates library errors.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.IoError.html" title="mysql_async::IoError enum">IoError</a></div><div class="item-right docblock-short">This type enumerates IO errors.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.IsolationLevel.html" title="mysql_async::IsolationLevel enum">IsolationLevel</a></div><div class="item-right docblock-short">Transaction isolation level.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.LocalInfileError.html" title="mysql_async::LocalInfileError enum">LocalInfileError</a></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Params.html" title="mysql_async::Params enum">Params</a></div><div class="item-right docblock-short">Representations of parameters of a prepared statement.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ParseError.html" title="mysql_async::ParseError enum">ParseError</a></div><div class="item-right docblock-short">Errors that can occur during parsing.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.SessionStateChange.html" title="mysql_async::SessionStateChange enum">SessionStateChange</a></div><div class="item-right docblock-short">Represents a parsed change in a session state (part of MySql’s Ok packet).</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.UrlError.html" title="mysql_async::UrlError enum">UrlError</a></div><div class="item-right docblock-short">This type enumerates connection URL errors.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Value.html" title="mysql_async::Value enum">Value</a></div><div class="item-right docblock-short">Client side representation of a value of MySql column.</div></div></div><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.DEFAULT_INACTIVE_CONNECTION_TTL.html" title="mysql_async::DEFAULT_INACTIVE_CONNECTION_TTL constant">DEFAULT_INACTIVE_CONNECTION_TTL</a></div><div class="item-right docblock-short">Default <code>inactive_connection_ttl</code> of a pool.</div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.DEFAULT_POOL_CONSTRAINTS.html" title="mysql_async::DEFAULT_POOL_CONSTRAINTS constant">DEFAULT_POOL_CONSTRAINTS</a></div><div class="item-right docblock-short">Default pool constraints.</div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.DEFAULT_STMT_CACHE_SIZE.html" title="mysql_async::DEFAULT_STMT_CACHE_SIZE constant">DEFAULT_STMT_CACHE_SIZE</a></div><div class="item-right docblock-short">Each connection will cache up to this number of statements by default.</div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.DEFAULT_TTL_CHECK_INTERVAL.html" title="mysql_async::DEFAULT_TTL_CHECK_INTERVAL constant">DEFAULT_TTL_CHECK_INTERVAL</a></div><div class="item-right docblock-short">Default <code>ttl_check_interval</code> of a pool.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.from_row.html" title="mysql_async::from_row fn">from_row</a></div><div class="item-right docblock-short">Will <em>panic</em> if could not convert <code>row</code> to <code>T</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.from_row_opt.html" title="mysql_async::from_row_opt fn">from_row_opt</a></div><div class="item-right docblock-short">Will return <code>Err(row)</code> if could not convert <code>row</code> to <code>T</code></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.from_value.html" title="mysql_async::from_value fn">from_value</a></div><div class="item-right docblock-short">Will panic if could not convert <code>v</code> to <code>T</code></div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.from_value_opt.html" title="mysql_async::from_value_opt fn">from_value_opt</a></div><div class="item-right docblock-short">Will return <code>Err(FromValueError(v))</code> if could not convert <code>v</code> to <code>T</code></div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.InfileData.html" title="mysql_async::InfileData type">InfileData</a></div><div class="item-right docblock-short">LOCAL INFILE data is a stream of <code>std::io::Result&lt;Bytes&gt;</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Result.html" title="mysql_async::Result type">Result</a></div><div class="item-right docblock-short">Result type alias for this library.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="mysql_async" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.0 (2c8cc3432 2023-03-06)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>