<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Sets a counter to an absolute value."><meta name="keywords" content="rust, rustlang, rust-lang, absolute_counter"><title>absolute_counter in metrics - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-93196c7a1c3542a8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-4743e13df3dfe8c4.css"><link rel="stylesheet" disabled href="../static.files/dark-0e1b889528bd466b.css"><link rel="stylesheet" disabled href="../static.files/ayu-65289d5d067c7c66.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc macro"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../metrics/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../metrics/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In metrics</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Macro <a href="index.html">metrics</a>::<wbr><a class="macro" href="#">absolute_counter</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/metrics_macros/lib.rs.html#167">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><div class="item-decl"><pre class="rust"><code>absolute_counter!() { /* proc-macro */ }</code></pre></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Sets a counter to an absolute value.</p>
<p>Counters represent a single monotonic value, which means the value can only be incremented, not
decremented, and will always start out with an initial value of zero.</p>
<p>Using this macro, users can specify an absolute value for the counter instead of the typical
delta.  This can be useful when dealing with forwarding metrics from an external system into the
normal application metrics, without having to track the delta of the metrics from the external
system.  Users should beware, though, that implementations will enforce the monotonicity
property of counters by refusing to update the value unless it is greater than current value of
the counter.</p>
<p>Metric names are shown below using string literals, but they can also be owned <code>String</code> values,
which includes using macros such as <code>format!</code> directly at the callsite. String literals are
preferred for performance where possible.</p>
<h2 id="example"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// A basic counter:
</span><span class="macro">absolute_counter!</span>(<span class="string">&quot;some_metric_name&quot;</span>, <span class="number">12</span>);

<span class="comment">// Specifying labels inline, including using constants for either the key or value:
</span><span class="macro">absolute_counter!</span>(<span class="string">&quot;some_metric_name&quot;</span>, <span class="number">13</span>, <span class="string">&quot;service&quot; </span>=&gt; <span class="string">&quot;http&quot;</span>);

<span class="kw">const </span>SERVICE_LABEL: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str = <span class="string">&quot;service&quot;</span>;
<span class="kw">const </span>SERVICE_HTTP: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str = <span class="string">&quot;http&quot;</span>;
<span class="macro">absolute_counter!</span>(<span class="string">&quot;some_metric_name&quot;</span>, <span class="number">13</span>, SERVICE_LABEL =&gt; SERVICE_HTTP);

<span class="comment">// We can also pass labels by giving a vector or slice of key/value pairs:
</span><span class="kw">let </span>dynamic_val = <span class="string">&quot;woo&quot;</span>;
<span class="kw">let </span>labels = [(<span class="string">&quot;dynamic_key&quot;</span>, <span class="macro">format!</span>(<span class="string">&quot;{}!&quot;</span>, dynamic_val))];
<span class="macro">absolute_counter!</span>(<span class="string">&quot;some_metric_name&quot;</span>, <span class="number">14</span>, <span class="kw-2">&amp;</span>labels);

<span class="comment">// As mentioned in the documentation, metric names also can be owned strings, including ones
// generated at the callsite via things like `format!`:
</span><span class="kw">let </span>name = String::from(<span class="string">&quot;some_owned_metric_name&quot;</span>);
<span class="macro">absolute_counter!</span>(name, <span class="number">15</span>);

<span class="macro">absolute_counter!</span>(<span class="macro">format!</span>(<span class="string">&quot;{}_via_format&quot;</span>, <span class="string">&quot;name&quot;</span>), <span class="number">16</span>);</code></pre></div>
</div></details></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="metrics" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.0 (2c8cc3432 2023-03-06)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>