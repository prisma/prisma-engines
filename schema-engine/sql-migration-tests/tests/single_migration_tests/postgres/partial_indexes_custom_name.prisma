// tags=postgres
// exclude=cockroachdb

datasource testds {
    provider = "postgresql"
    url = env("TEST_DATABASE_URL")
}

generator js {
    provider = "prisma-client-js"
    previewFeatures = ["partialIndexes"]
}

model Product {
  id     Int      @id @default(autoincrement())
  name   String?  @testds.VarChar(255)
  active Boolean  @default(true)

  @@index([name], map: "idx_active_products", where: "active = true")
}

// -- CreateTable
// CREATE TABLE "Product" (
//     "id" SERIAL NOT NULL,
//     "name" VARCHAR(255),
//     "active" BOOLEAN NOT NULL DEFAULT true,
//
//     CONSTRAINT "Product_pkey" PRIMARY KEY ("id")
// );

// -- CreateIndex
// CREATE INDEX "idx_active_products" ON "Product"("name") WHERE active = true;
// Expected Migration:
// -- CreateSchema
// CREATE SCHEMA IF NOT EXISTS "public";
// 
// -- CreateTable
// CREATE TABLE "public"."Product" (
//     "id" SERIAL NOT NULL,
//     "name" VARCHAR(255),
//     "active" BOOLEAN NOT NULL DEFAULT true,
// 
//     CONSTRAINT "Product_pkey" PRIMARY KEY ("id")
// );
// 
// -- CreateIndex
// CREATE INDEX "idx_active_products" ON "public"."Product"("name") WHERE active = true;
